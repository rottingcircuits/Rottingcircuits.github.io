<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Audio Reactive CRT Slime</title>

<!-- iOS fullscreen app-like display -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<style>
  html, body {
    margin: 0;
    padding: 0;
    background: black;
    height: 100%;
    width: 100%;
    overflow: hidden;
  }
  canvas {
    display: block;
    height: 100%;
    width: 100%;
  }
</style>
</head>
<body>
<script src="https://unpkg.com/hydra-synth"></script>
<script>
  const hydra = new Hydra({ detectAudio: false });
  let ampLevel = 0;

  // --- Prevent screen sleep (Wake Lock) ---
  if ('wakeLock' in navigator) {
    let wakeLock = null;
    const requestWakeLock = async () => {
      try {
        wakeLock = await navigator.wakeLock.request('screen');
        wakeLock.addEventListener('release', () => {
          console.log('Screen Wake Lock released');
        });
        console.log('Screen Wake Lock active');
      } catch (err) {
        console.error('Wake Lock error:', err);
      }
    };
    requestWakeLock();
    document.addEventListener('visibilitychange', () => {
      if (wakeLock !== null && document.visibilityState === 'visible') {
        requestWakeLock();
      }
    });
  }

  // Random motion every 10 seconds, less vibrant pink, more grey
// seconds
// — Voluptuous Flesh Mutations with Breathing —
// swelling, bulbous, organic forms with slow inhale/exhale

speed = 0.5

// Breathing modulation
breath = () => 1 + 0.08 * Math.sin(time * 0.35)  // slow inhale/exhale

// Base swelling flesh
flesh = () => noise(2,0.25)
  .pixelate(150,150)
  .kaleid(5)
  .scale( ()=>breath() + 0.2*Math.sin(time*0.3) )
  .color(1.3,0.8,0.7)
  .contrast(1.15)
  .brightness(0.18)

// Oscillating bulges with smooth pulsation
bulges = () => osc(5,0.08,0.3)
  .modulate(noise(3,0.15),0.4)
  .rotate( ()=>0.15*Math.sin(time*0.25) )
  .scale( ()=>breath() + 0.25*Math.sin(time*0.6) )
  .kaleid(8)
  .color(1.1,0.6,0.7)
  .contrast(1.2)
  .brightness(0.1)

// Shimmering “skin” overlay
skin = () => voronoi(8,0.1,15)
  .modulate(noise(1.5,0.2),0.3)
  .brightness(0.25)
  .contrast(1.05)
  .color(1.4,1.0,1.0)
  .luma(0.4,0.25)

// Final blend
flesh()
  .blend(bulges(),0.65)
  .layer(skin().mult(flesh(),0.4))
  .modulate(noise(2.5,0.15),0.2)
  .saturate(1.2)
  .contrast(1.1)
  .scale( ()=>breath() ) // gentle global breathing
  .out(o0)

  // --- Slime generator ---
  
  // --- Vertical roll ---
  
</script>
</body>
</html>
